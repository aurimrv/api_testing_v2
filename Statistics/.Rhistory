setwd("~/OneDrive/temp/00-orientacoes/andre/api_testing_v2/Statistics")
ggplot(data_long, aes(x = Time_Point, y = Value, fill = Time_Point)) +
geom_boxplot(alpha = 0.7) +
geom_jitter(width = 0.2, size = 2, alpha = 0.5) +
theme_minimal() +
labs(title = "Distribution of Values Across Time Points",
x = "Time Point",
y = "Value",
fill = "Time Point") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
legend.position = "none")
# Read data
data <- read.csv("/mnt/user-data/uploads/rq1_instructions.csv")
# Load required libraries
library(tidyverse)
# Set working directory and read data
# rq1_instructions OR rq1_brances (replace ALL for running on different dataset)
data <- read.csv("rq1_instructions.csv")
# Set working directory and read data
# rq1_instructions OR rq1_brances (replace ALL for running on different dataset)
data <- read.csv("rq1_instructions.csv")
# Set working directory and read data
# rq1_instructions OR rq1_brances (replace ALL for running on different dataset)
data <- read.csv("rq1_instructions.csv")
# Set working directory and read data
# rq1_instructions OR rq1_brances (replace ALL for running on different dataset)
data <- read.csv("rq1_instructions.csv")
# Display the dataset
cat("=================================================================\n")
# Statistical Analysis Script
# Performs descriptive statistics, Shapiro-Wilk normality test,
# and Wilcoxon signed-rank tests for paired comparisons
# Load required libraries
library(tidyverse)
# Set working directory and read data
# rq1_instructions OR rq1_brances (replace ALL for running on different dataset)
data <- read.csv("rq1_instructions.csv")
# Display the dataset
cat("=================================================================\n")
cat("                    DATASET OVERVIEW\n")
cat("=================================================================\n\n")
print(data)
cat("\n")
# =====================================================================
# 1. DESCRIPTIVE STATISTICS
# =====================================================================
cat("=================================================================\n")
cat("                 DESCRIPTIVE STATISTICS\n")
cat("=================================================================\n\n")
# Extract the numeric columns (T0, T1, T2, T3)
time_points <- data[, c("T0", "T1", "T2", "T3")]
# Calculate descriptive statistics for each time point
desc_stats <- data.frame(
Time_Point = c("T0", "T1", "T2", "T3"),
Mean = sapply(time_points, mean),
Median = sapply(time_points, median),
SD = sapply(time_points, sd),
Min = sapply(time_points, min),
Max = sapply(time_points, max),
Q1 = sapply(time_points, quantile, probs = 0.25),
Q3 = sapply(time_points, quantile, probs = 0.75),
IQR = sapply(time_points, IQR)
)
print(desc_stats, row.names = FALSE)
cat("\n")
# =====================================================================
# 2. SHAPIRO-WILK NORMALITY TEST (α = 0.05)
# =====================================================================
cat("=================================================================\n")
cat("          SHAPIRO-WILK NORMALITY TEST (95% CI, α = 0.05)\n")
cat("=================================================================\n\n")
cat("Null Hypothesis (H0): The data follows a normal distribution\n")
cat("Alternative Hypothesis (H1): The data does NOT follow a normal distribution\n")
cat("Decision Rule: Reject H0 if p-value < 0.05\n\n")
shapiro_results <- data.frame(
Time_Point = character(),
W_Statistic = numeric(),
P_Value = numeric(),
Normal = character(),
stringsAsFactors = FALSE
)
for (col in c("T0", "T1", "T2", "T3")) {
test_result <- shapiro.test(time_points[[col]])
is_normal <- ifelse(test_result$p.value >= 0.05, "Yes (p ≥ 0.05)", "No (p < 0.05)")
shapiro_results <- rbind(shapiro_results, data.frame(
Time_Point = col,
W_Statistic = round(test_result$statistic, 4),
P_Value = round(test_result$p.value, 4),
Normal = is_normal
))
}
print(shapiro_results, row.names = FALSE)
cat("\n")
# Interpretation
cat("INTERPRETATION:\n")
any_non_normal <- any(shapiro_results$P_Value < 0.05)
if (any_non_normal) {
cat("At least one group shows non-normal distribution (p < 0.05).\n")
cat("Therefore, NON-PARAMETRIC tests (Wilcoxon signed-rank) are appropriate.\n\n")
} else {
cat("All groups show normal distribution (p ≥ 0.05).\n")
cat("However, given the small sample size (n=5), NON-PARAMETRIC tests are still recommended.\n\n")
}
# =====================================================================
# 3. WILCOXON SIGNED-RANK TEST (α = 0.05)
# =====================================================================
cat("=================================================================\n")
cat("    WILCOXON SIGNED-RANK TEST FOR PAIRED COMPARISONS (α = 0.05)\n")
cat("=================================================================\n\n")
cat("Null Hypothesis (H0): No significant difference between paired groups\n")
cat("Alternative Hypothesis (H1): Significant difference exists between paired groups\n")
cat("Decision Rule: Reject H0 if p-value < 0.05\n\n")
# Define the comparisons
comparisons <- list(
c("T0", "T3"),
c("T0", "T1"),
c("T1", "T2"),
c("T2", "T3")
)
wilcoxon_results <- data.frame(
Comparison = character(),
V_Statistic = numeric(),
P_Value = numeric(),
Significant = character(),
Effect = character(),
stringsAsFactors = FALSE
)
for (comp in comparisons) {
group1 <- comp[1]
group2 <- comp[2]
# Perform Wilcoxon signed-rank test (paired, two-tailed)
test_result <- wilcox.test(time_points[[group1]],
time_points[[group2]],
paired = TRUE,
exact = FALSE,
conf.int = TRUE)
# Determine significance
is_significant <- ifelse(test_result$p.value < 0.05,
"Yes (p < 0.05)",
"No (p ≥ 0.05)")
# Determine effect direction
median_diff <- median(time_points[[group2]] - time_points[[group1]])
effect_dir <- ifelse(median_diff > 0,
paste0(group2, " > ", group1),
paste0(group2, " < ", group1))
wilcoxon_results <- rbind(wilcoxon_results, data.frame(
Comparison = paste0(group1, " vs ", group2),
V_Statistic = test_result$statistic,
P_Value = round(test_result$p.value, 4),
Significant = is_significant,
Effect = effect_dir
))
}
print(wilcoxon_results, row.names = FALSE)
cat("\n")
# =====================================================================
# 4. DETAILED INTERPRETATION OF RESULTS
# =====================================================================
cat("=================================================================\n")
cat("                  DETAILED INTERPRETATION\n")
cat("=================================================================\n\n")
cat("DESCRIPTIVE STATISTICS SUMMARY:\n")
cat("--------------------------------\n")
cat(sprintf("- T0: Mean = %.2f (SD = %.2f), Range: [%.2f - %.2f]\n",
desc_stats$Mean[1], desc_stats$SD[1], desc_stats$Min[1], desc_stats$Max[1]))
cat(sprintf("- T1: Mean = %.2f (SD = %.2f), Range: [%.2f - %.2f]\n",
desc_stats$Mean[2], desc_stats$SD[2], desc_stats$Min[2], desc_stats$Max[2]))
cat(sprintf("- T2: Mean = %.2f (SD = %.2f), Range: [%.2f - %.2f]\n",
desc_stats$Mean[3], desc_stats$SD[3], desc_stats$Min[3], desc_stats$Max[3]))
cat(sprintf("- T3: Mean = %.2f (SD = %.2f), Range: [%.2f - %.2f]\n\n",
desc_stats$Mean[4], desc_stats$SD[4], desc_stats$Min[4], desc_stats$Max[4]))
cat("The data shows an overall increasing trend from T0 to T3, suggesting\n")
cat("progressive improvement across time points.\n\n")
cat("\nNORMALITY TEST RESULTS:\n")
cat("----------------------\n")
for (i in 1:nrow(shapiro_results)) {
cat(sprintf("- %s: W = %.4f, p-value = %.4f → %s\n",
shapiro_results$Time_Point[i],
shapiro_results$W_Statistic[i],
shapiro_results$P_Value[i],
shapiro_results$Normal[i]))
}
cat("\nGiven the small sample size (n = 5 projects), the Wilcoxon signed-rank test\n")
cat("is appropriate for comparing paired observations, as it does not assume normality.\n\n")
cat("\nWILCOXON TEST RESULTS:\n")
cat("----------------------\n")
for (i in 1:nrow(wilcoxon_results)) {
cat(sprintf("\n%d. %s:\n", i, wilcoxon_results$Comparison[i]))
cat(sprintf("   V-statistic = %d, p-value = %.4f\n",
wilcoxon_results$V_Statistic[i],
wilcoxon_results$P_Value[i]))
cat(sprintf("   Result: %s\n", wilcoxon_results$Significant[i]))
cat(sprintf("   Effect: %s\n", wilcoxon_results$Effect[i]))
if (wilcoxon_results$P_Value[i] < 0.05) {
cat("   → There IS a statistically significant difference between these time points.\n")
} else {
cat("   → There is NO statistically significant difference between these time points.\n")
}
}
cat("\n\nOVERALL CONCLUSIONS:\n")
cat("-------------------\n")
# Count significant differences
sig_count <- sum(wilcoxon_results$P_Value < 0.05)
if (sig_count == 0) {
cat("No statistically significant differences were found in any of the paired comparisons.\n")
cat("This suggests that the changes across time points may not be substantial enough\n")
cat("to detect with the current sample size.\n")
} else if (sig_count == nrow(wilcoxon_results)) {
cat("All paired comparisons show statistically significant differences.\n")
cat("This indicates consistent and meaningful changes across all time points.\n")
} else {
cat(sprintf("%d out of %d comparisons show statistically significant differences.\n",
sig_count, nrow(wilcoxon_results)))
cat("\nSignificant changes detected in:\n")
sig_comps <- wilcoxon_results$Comparison[wilcoxon_results$P_Value < 0.05]
for (comp in sig_comps) {
cat(sprintf("  - %s\n", comp))
}
}
cat("\n")
cat("=================================================================\n")
cat("                    ANALYSIS COMPLETE\n")
cat("=================================================================\n")
# =====================================================================
# 5. OPTIONAL: CREATE VISUALIZATION
# =====================================================================
cat("\n\nCreating visualization...\n")
# Reshape data for plotting
data_long <- data %>%
pivot_longer(cols = c(T0, T1, T2, T3),
names_to = "Time_Point",
values_to = "Value")
data_long$Time_Point <- factor(data_long$Time_Point, levels = c("T0", "T1", "T2", "T3"))
# Create boxplot
png("rq1_instructions_boxplot_analysis.png", width = 800, height = 600, res = 100)
ggplot(data_long, aes(x = Time_Point, y = Value, fill = Time_Point)) +
geom_boxplot(alpha = 0.7) +
geom_jitter(width = 0.2, size = 2, alpha = 0.5) +
theme_minimal() +
labs(title = "Distribution of Values Across Time Points",
x = "Time Point",
y = "Value",
fill = "Time Point") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
legend.position = "none")
dev.off()
# Create line plot for individual projects
png("rq1_instructions_lineplot_analysis.png", width = 800, height = 600, res = 100)
ggplot(data_long, aes(x = Time_Point, y = Value, group = Project, color = Project)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
theme_minimal() +
labs(title = "Trend of Values Across Time Points by Project",
x = "Time Point",
y = "Value",
color = "Project") +
theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"))
dev.off()
cat("Visualizations saved to\n")
cat("  - rq1_instructions_boxplot_analysis.png\n")
cat("  - rq1_instructions_lineplot_analysis.png\n")
